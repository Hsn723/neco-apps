apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - contour/upstream/01-crds.yaml
  - contour/upstream/02-rbac.yaml
  - contour/upstream/02-service-contour.yaml
  - contour/upstream/03-contour.yaml
  - contour/upstream/03-envoy.yaml
  - contour/certificate.yaml
  - contour/common.yaml
  - contour/contour-config.yaml
  - contour/pdb.yaml
  - contour/rbac_contour-plus.yaml
  - contour/service.yaml
patchesStrategicMerge:
  - contour/deployment.yaml
  - contour/rbac_contour.yaml
  - contour/service_contour.yaml
patchesJson6902:
  - target:
      group: apiextensions.k8s.io
      version: v1beta1
      kind: CustomResourceDefinition
      name: httpproxies.projectcontour.io
    path: contour/jsonpatch/crd.yaml
  - target:
      group: apiextensions.k8s.io
      version: v1beta1
      kind: CustomResourceDefinition
      name: ingressroutes.contour.heptio.com
    path:  contour/jsonpatch/crd.yaml
  - target:
      group: apiextensions.k8s.io
      version: v1beta1
      kind: CustomResourceDefinition
      name: tlscertificatedelegations.contour.heptio.com
    path:  contour/jsonpatch/crd.yaml
  - target:
      group: apiextensions.k8s.io
      version: v1beta1
      kind: CustomResourceDefinition
      name: tlscertificatedelegations.projectcontour.io
    path:  contour/jsonpatch/crd.yaml
  - target:
      group: rbac.authorization.k8s.io
      version: v1beta1
      kind: Role
      name: contour-leaderelection
      namespace: projectcontour
    path: contour/jsonpatch/replace-ns.yaml
  - target:
      group: rbac.authorization.k8s.io
      version: v1beta1
      kind: RoleBinding
      name: contour-leaderelection
      namespace: projectcontour
    path: contour/jsonpatch/replace-ns.yaml
  - target:
      version: v1
      kind: Service
      name: contour
      namespace: projectcontour
    path: contour/jsonpatch/service_contour.yaml
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: contour
      namespace: projectcontour
    path: contour/jsonpatch/deployment_contour.yaml
  - target:
      group: apps
      version: v1
      kind: DaemonSet
      name: envoy
      namespace: projectcontour
    path: contour/jsonpatch/deployment_envoy.yaml
